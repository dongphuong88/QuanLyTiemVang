<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="w3/css/w3.css">
    <link rel="stylesheet" href="w3/js/w3data.js">
    <link rel="stylesheet" href="css/common.css">
    <script src="js/jquery-2.2.4.min.js"></script>
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.0/css/font-awesome.min.css">
</head>

<body>
    <div class="row" style="border:solid 1px green;">
        <div class="ipadMiniScreen"></div>
        <div class="iphoneScreen"></div>
    </div>
    <div>
        <table class="w3-table w3-bordered w3-striped w3-card-4">
            <thead>
                <tr class="w3-red">
                    <th scope="col"></th>
                    <th scope="col" style="text-align:right;" id="name9999">999.9</th>
                    <th scope="col" style="text-align:right;" id="nameNuTrang24K">Nữ Trang 24K</th>
                    <th scope="col" style="text-align:right;" id="name680">680</th>
                    <th scope="col" style="text-align:right;" id="name625">625</th>
                    <th scope="col" style="text-align:right;" id="name610">610</th>
                    <th scope="col" style="text-align:right;" id="name600">600</th>
                    <th scope="col" style="text-align:right;" id="name560">560</th>
                </tr>
            </thead>
            <tr>
                <th scope="row">Mua</th>
                <td id="buy9999" style="text-align:right;">5000</td>
                <td id="buyNuTrang24K" style="text-align:right;">1000</td>
                <td id="buy680" style="text-align:right;"></td>
                <td id="buy625" style="text-align:right;"></td>
                <td id="buy610" style="text-align:right;"></td>
                <td id="buy600" style="text-align:right;"></td>
                <td id="buy560" style="text-align:right;"></td>
            </tr>
            <tr>
                <th scope="row">Bán</th>
                <td id="sell9999" style="text-align:right;">3000</td>
                <td id="sellNuTrang24K" style="text-align:right;">8000</td>
                <td id="sell680" style="text-align:right;"></td>
                <td id="sell625" style="text-align:right;"></td>
                <td id="sell610" style="text-align:right;"></td>
                <td id="sell600" style="text-align:right;"></td>
                <td id="sell560" style="text-align:right;"></td>
            </tr>
        </table>
    </div>
    <header class="w3-container w3-teal">
        <h1 id="head">Loại Giao Dịch</h1>
    </header>
    <div class="w3-container w3-center hideActionButton showActionButton">
        <a class="w3-btn w3-orange w3-xlarge w3-round-large w3-padding-jumbo" onclick="clickBuy()">Mua</a>
        <a class="w3-btn w3-orange w3-xlarge w3-round-large w3-padding-jumbo" onclick="clickSell()">Bán</a>
        <a class="w3-btn w3-orange w3-xlarge w3-round-large w3-padding-jumbo" onclick="clickTrade()">Trao Đổi</a>
    </div>
    <div class="hideActionButton showBuy" hidden>
        <div id="buyRow">
            <div id="buyFirstRow"></div>
        </div>
        <div class="w3-container w3-center" style="width:80%">
            <button class="w3-btn w3-blue w3-xlarge w3-round-large w3-padding-large" style="margin-top:10px" onclick="addBuyRow()">Thêm</button>
            <button class="w3-btn w3-red w3-xlarge w3-round-large w3-padding-large" style="margin-top:10px" onclick="clearBuy()">Xóa</button>
            <button class="w3-btn w3-green w3-xlarge w3-round-large w3-padding-large" style="margin-top:10px" onclick="calBuy()">Tính Mua</button>

        </div>
    </div>
    <div class="hideActionButton showSell" hidden>
        <div id="sellRow">
            <div id="sellFirstRow"></div>
        </div>
        <div class="w3-container w3-center" style="width:80%">
            <button class="w3-btn w3-blue w3-xlarge w3-round-large w3-padding-large" style="margin-top:10px" onclick="addSellRow()">Thêm</button>
            <button class="w3-btn w3-red w3-xlarge w3-round-large w3-padding-large" style="margin-top:10px" onclick="clearSell()">Xóa</button>
            <button class="w3-btn w3-green w3-xlarge w3-round-large w3-padding-large" style="margin-top:10px" onclick="calSell()">Tính Bán</button>

        </div>
    </div>
    <div class="hideActionButton showTrade" hidden>
        <div id="buyTradeRow" class="w3-container w3-card-4" style="margin-bottom:20px; padding-bottom:20px">
            <header class="w3-green">
                <h3>Mua</h3></header>
            <div id="buyFirstTradeRow"></div>

        </div>
        <div id="sellTradeRow" class="w3-container w3-card-4" style="margin-bottom:20px; padding-bottom:20px">
            <header class="w3-green">
                <h3>Bán</h3></header>
            <div id="sellFirstTradeRow"></div>
        </div>
        <div>
            <div class="w3-container w3-center" style="clear:left">
                <button class="w3-btn w3-blue w3-xlarge w3-round-large w3-padding-small" style="margin-top:10px" onclick="addBuyTradeRow()">Thêm Mua</button>
                <button class="w3-btn w3-blue w3-xlarge w3-round-large w3-padding-small" style="margin-top:10px" onclick="addSellTradeRow()">Thêm Bán</button>
                <button class="w3-btn w3-red w3-xlarge w3-round-large w3-padding-small" style="margin-top:10px" onclick="clearBuyTrade()">Xóa Mua</button>
                <button class="w3-btn w3-red w3-xlarge w3-round-large w3-padding-small" style="margin-top:10px" onclick="clearSellTrade()">Xóa Bán</button>
                <button class="w3-btn w3-green w3-xlarge w3-round-large w3-padding-small" style="margin-top:10px; width:150px" onclick="calTrade()">Tính Đổi</button>

            </div>
        </div>
        <div id="calArea" hidden>
            <div id="calBuy9999"></div>
            <div id="calBuy9999La"></div>
            <div id="calSell9999"></div>
            <div id="calBuyNuTrang24K"></div>
            <div id="calBuyNuTrang24KLa"></div>
            <div id="calSellNuTrang24K"></div>
            <div id="calBuy680"></div>
            <div id="calBuy680La"></div>
            <div id="calSell680"></div>
            <div id="calBuy625"></div>
            <div id="calBuy625La"></div>
            <div id="calSell625"></div>
            <div id="calBuy610"></div>
            <div id="calBuy610La"></div>
            <div id="calSell610"></div>
            <div id="calBuy600"></div>
            <div id="calBuy600La"></div>
            <div id="calSell600"></div>
            <div id="calBuy560"></div>
            <div id="calBuy560La"></div>
            <div id="calSell560"></div>
        </div>
    </div>
    <div class="hideActionButton showTotal" hidden>
        <div class="w3-container" style="margin-top:10px;">
            <div class="w3-container" style="width:35%;float:left">
                <label class="w3-label">Tổng Cộng:</label>
                <input id="totalAmount" class="w3-input w3-text-red" type="number" style="font-size:3em">
            </div>
            <div class=" w3-container" style="width:35%;float:left">
                <label class="w3-label">Tiền Thu:</label>
                <input id="getAmount" class="w3-input" type="number" style="font-size:3em">
            </div>
            <div style="width:5%;float:left">
                <a class="w3-btn w3-blue" style="padding:20px;margin:20px -15px" onclick="$('#returnAmount').val($('#getAmount').val() - $('#totalAmount').val())"><i class="fa fa-calculator" aria-hidden="true"></i></a>
            </div>
            <div class=" w3-container" style="width:25%;float:left">
                <label class="w3-label">Tiền Thối:</label>
                <input id="returnAmount" class="w3-input w3-text-green" type="number" style="font-size:3em">
            </div>
        </div>
        <!-- START Detail -->
        <div class="w3-container">
        <header class="w3-green">
                <h3 style="margin-bottom:0px">Chi Tiết</h3></header>
        </div>
        <div class="w3-container">
          <ul class="w3-ul w3-border" id="detailContent" >test
            </ul>
        </div>
        <!-- END Detail -->
    </div>
            <script>
                /******** Mapping Data **********/
                /*
                $('#sell9999').html(localStorage.getItem("sell9999"));
                $('#buy9999').html(localStorage.getItem("buy9999"));
                $('#sellNuTrang24K').html(localStorage.getItem("sellNuTrang24K"));
                $('#buyNuTrang24K').html(localStorage.getItem("buyNuTrang24K"));
                */
                $('#sell680').html(localStorage.getItem("sell680"));
                $('#buy680').html(localStorage.getItem("buy680"));
                $('#sell625').html(localStorage.getItem("sell625"));
                $('#buy625').html(localStorage.getItem("buy625"));
                $('#sell610').html(localStorage.getItem("sell610"));
                $('#buy610').html(localStorage.getItem("buy610"));
                $('#sell600').html(localStorage.getItem("sell600"));
                $('#buy600').html(localStorage.getItem("buy600"));
                $('#sell560').html(localStorage.getItem("sell560"));
                $('#buy560').html(localStorage.getItem("buy560"));
                /******** END Mapping Data **********/

                /******** Action button functions ******/
                // Button Actions
                function clickBuy() {
                    $('.hideActionButton').hide();
                    $('.showBuy').show();
                    $('#head').html('<button class="w3-btn w3-yellow w3-xlarge w3-round-large w3-padding-large" onclick="clickBack()">Quay Lại</button> Mua');
                    addFirstBuyRow();
                }

                function clickSell() {
                    $('.hideActionButton').hide();
                    $('.showSell').show();
                    $('#head').html('<button class="w3-btn w3-yellow w3-xlarge w3-round-large w3-padding-large" onclick="clickBack()">Quay Lại</button> Bán');
                    addFirstSellRow();
                }

                function clickTrade() {
                    $('.hideActionButton').hide();
                    $('.showTrade').show();
                    $('#head').html('<button class="w3-btn w3-yellow w3-xlarge w3-round-large w3-padding-large" onclick="clickBack()">Quay Lại</button> Đổi');
                    addFirstSellTradeRow();
                    addFirstBuyTradeRow();
                }

                function clickBack() {
                    $('.hideActionButton').hide();
                    $('.showActionButton').show();
                    $('#head').html('Loại Giao Dịch');
                }
                /******** END Action button functions ******/

                /******** Buy Functions ******/
                // Add first Buy row
                function addFirstBuyRow() {
                    var html = '<div class="buyRow"><div class="w3-container" style="width:30%;float:left">' + '<label class="w3-label w3-validate">Loại Mua:</label>' + '<select class="w3-select">' + '<option value="9999">999.9</option>' + '<option value="NuTrang24K">Nữ Trang 24K</option>' + '<option value="680">680</option>' + '<option value="625">625</option>' + '<option value="610">610</option>' + '<option value="600">600</option>' + '<option value="560">560</option>' + '</select>' + '</div>' + '<div class="w3-container" style="width:30%;float:left">' + '<label class="w3-label w3-validate">Cân Nặng (ly):</label> <input class="w3-input canNang"' + 'type="number" value="0" onfocus="$(this).select()">' + '</div>' + '<div class="w3-container" style="width:30%;float:left">' + '<label class="w3-label w3-validate">Bù (ngàn/chỉ):</label> <input class="w3-input buTien"' + 'type="number" value="0" onfocus="$(this).select()">' + '</div>' + '<div class="w3-container w3-right" style="width:10%;float:left"></div><div>';
                    $('#buyFirstRow').html(html);
                }
                // Add more Buy row
                function addBuyRow() {
                    var html = '<div class="buyRow extraBuyRow"><div class="w3-container" style="width:30%;float:left">' + '<label class="w3-label w3-validate">Loại Mua:</label>' + '<select class="w3-select">' + '<option value="9999">999.9</option>' + '<option value="NuTrang24K">Nữ Trang 24K</option>' + '<option value="680">680</option>' + '<option value="625">625</option>' + '<option value="610">610</option>' + '<option value="600">600</option>' + '<option value="560">560</option>' + '</select>' + '</div>' + '<div class="w3-container" style="width:30%;float:left">' + '<label class="w3-label w3-validate">Cân Nặng (ly):</label> <input class="w3-input canNang"' + 'type="number" value="0" onfocus="$(this).select()">' + '</div>' + '<div class="w3-container" style="width:30%;float:left">' + '<label class="w3-label w3-validate">Bù (ngàn/chỉ):</label> <input class="w3-input buTien"' + 'type="number" value="0" onfocus="$(this).select()">' + '</div>' + '<div class="w3-container" style="width:10%;float:left">' + '<a class="w3-btn w3-xlarge" onclick="$(this).parent().parent().remove()"><i class="fa fa-minus-circle" aria-hidden="true"></i></a>' + '</div></div>';
                    $('#buyRow').append(html);
                }
                // Cal Buy
                function calBuy() {
                    var total = 0, selectedOption, isProcessFurther = true,
                        tagID, goldType, price, weight, extraSub, rowTotal;
                    var detailListHtml = "";
                    $('#buyRow .buyRow').each(function (index) {
                        selectedOption = $(this).find('select').find(':selected');
                        goldType = selectedOption.text();
                        tagID = "#buy" + selectedOption.val();
                        price = $(tagID).html();
                        weight = $(this).find('.canNang').val();
                        extraSub = $(this).find('.buTien').val();
                        rowTotal = Math.ceil((price - extraSub) * weight / 100);
                        if (isNaN(rowTotal) || 0 >= rowTotal) {
                            alert("Kết quả sai. Xin vui lòng kiểm tra lại giá trị");
                            isProcessFurther = false;
                            return;
                        }
                            
                        // Add Detail
                        detailListHtml += '<li>Mua: '
                                        + readGoldWeight(weight) 
                                        + ' ,vàng: ' + goldType
                                        + ' ,tiền bù: ' + extraSub + ' ngàn/chỉ'
                                        + ' ,tổng cộng: ' + rowTotal + ' ngàn'
                                        +'</li>';
                        
                        total += rowTotal;
                    });
                    if( !isProcessFurther ) return;
                    
                    $('#detailContent').html(detailListHtml);
                    calTotal(-total);
                }
                // Clear Buy Form
                function clearBuy() {
                    $('#buyRow .extraBuyRow').remove();
                    $('#buyRow input').val(0);
                }
                /******** END Buy Functions ******/

                /******** Sell Functions ******/
                // Add first Sell row
                function addFirstSellRow() {
                    var html = '<div class="sellRow"><div class="w3-container" style="width:30%;float:left">' + '<label class="w3-label w3-validate">Loại Bán:</label>' + '<select class="w3-select">' + '<option value="9999">999.9</option>' + '<option value="NuTrang24K">Nữ Trang 24K</option>' + '<option value="680">680</option>' + '<option value="625">625</option>' + '<option value="610">610</option>' + '<option value="600">600</option>' + '<option value="560">560</option>' + '</select>' + '</div>' + '<div class="w3-container" style="width:30%;float:left">' + '<label class="w3-label w3-validate">Cân Nặng (ly):</label> <input class="w3-input canNang"' + 'type="number" value="0" onfocus="$(this).select()">' + '</div>' + '<div class="w3-container" style="width:30%;float:left">' + '<label class="w3-label w3-validate">Tiền Công:</label> <input class="w3-input tienCong"' + 'type="number" value="0" onfocus="$(this).select()">' + '</div>' + '<div class="w3-container w3-right" style="width:10%;float:left"></div><div>';
                    $('#sellFirstRow').html(html);
                }
                // Add more Sell row
                function addSellRow() {
                    var html = '<div class="sellRow extraSellRow"><div class="w3-container" style="width:30%;float:left">' + '<label class="w3-label w3-validate">Loại Bán:</label>' + '<select class="w3-select">' + '<option value="9999">999.9</option>' + '<option value="NuTrang24K">Nữ Trang 24K</option>' + '<option value="680">680</option>' + '<option value="625">625</option>' + '<option value="610">610</option>' + '<option value="600">600</option>' + '<option value="560">560</option>' + '</select>' + '</div>' + '<div class="w3-container" style="width:30%;float:left">' + '<label class="w3-label w3-validate">Cân Nặng (ly):</label> <input class="w3-input canNang"' + 'type="number" value="0" onfocus="$(this).select()">' + '</div>' + '<div class="w3-container" style="width:30%;float:left">' + '<label class="w3-label w3-validate">Tiền Công:</label> <input class="w3-input tienCong"' + 'type="number" value="0" onfocus="$(this).select()">' + '</div>' + '<div class="w3-container" style="width:10%;float:left">' + '<a class="w3-btn w3-xlarge" onclick="$(this).parent().parent().remove()"><i class="fa fa-minus-circle" aria-hidden="true"></i></a>' + '</div></div>';
                    $('#sellRow').append(html);
                }
                // Cal Sell
                function calSell() {
                    var total = 0, selectedOption, isProcessFurther = true,
                        tagID, goldType, price, weight, workerFee = 0, rowTotal;
                    var detailListHtml = "";
                    $('#sellRow .sellRow').each(function (index) {
                        selectedOption = $(this).find('select').find(':selected');
                        goldType = selectedOption.text();
                        tagID = "#sell" + selectedOption.val();
                        price = $(tagID).html();
                        weight = $(this).find('.canNang').val();
                        workerFee = $(this).find('.tienCong').val();
                        
                        rowTotal = Math.ceil( (price * weight / 100) + +workerFee);
                        if (isNaN(rowTotal) || 0 >= rowTotal) {
                            alert("Kết quả sai. Xin vui lòng kiểm tra lại giá trị");
                            isProcessFurther = false;
                            return;
                        }
                            
                        // Add Detail
                        detailListHtml += '<li>Bán: '
                                        + readGoldWeight(weight) 
                                        + ' ,vàng ' + goldType
                                        + ' ,tiền công ' + workerFee + ' ngàn'
                                        + ' ,tổng cộng ' + rowTotal + ' ngàn'
                                        +'</li>';
                        
                        total += rowTotal;
                    });
                    if( !isProcessFurther ) return;
                    
                    $('#detailContent').html(detailListHtml);
                    calTotal(total);

                }
                // Clear Sell Form
                function clearSell() {
                    $('#sellRow .extraSellRow').remove();
                    $('#sellRow input').val(0);
                }
                /******** END Buy Functions ******/

                /******** Trade Functions ******/
                // Add first Sell row
                function addFirstSellTradeRow() {
                    var html = '<div class="sellTradeRow"><div class="w3-container" style="width:30%;float:left">' + '<label>Loại Bán:</label>' + '<select class="w3-select">' + '<option value="9999">999.9</option>' + '<option value="NuTrang24K">Nữ Trang 24K</option>' + '<option value="680">680</option>' + '<option value="625">625</option>' + '<option value="610">610</option>' + '<option value="600">600</option>' + '<option value="560">560</option>' + '</select>' + '</div>' + '<div class="w3-container" style="width:30%;float:left">' + '<label>Cân Nặng (ly):</label> <input class="w3-input canNang"' + 'type="number" value="0" onfocus="$(this).select()">' + '</div>' + '<div class="w3-container" style="width:30%;float:left">' + '<label>Tiền Công:</label> <input class="w3-input tienCong"' + 'type="number" value="0" onfocus="$(this).select()">' + '</div>' + '<div class="w3-container w3-right" style="width:10%;float:left"></div><div>';
                    $('#sellFirstTradeRow').html(html);

                    html = '<div class="buyTradeRow"><div class="w3-container" style="width:30%;float:left">' + '<label>Loại Mua:</label>' + '<select class="w3-select">' + '<option value="9999">999.9</option>' + '<option value="NuTrang24K">Nữ Trang 24K</option>' + '<option value="680">680</option>' + '<option value="625">625</option>' + '<option value="610">610</option>' + '<option value="600">600</option>' + '<option value="560">560</option>' + '</select>' + '</div>' + '<div class="w3-container" style="width:30%;float:left">' + '<label>Cân Nặng (ly):</label> <input class="w3-input canNang"' + 'type="number" value="0" onfocus="$(this).select()">' + '</div>' + '<div class="w3-container" style="width:30%;float:left">' + '<label>Bù (ngàn/chỉ):</label> <input class="w3-input buTien"' + 'type="number" value="0" onfocus="$(this).select()">' + '</div>' + '<div class="w3-container w3-right" style="width:10%;float:left"><input class="w3-check isLa" type="checkbox">'
                    + '<label class="w3-validate">Lạ</label></div><div>';
                    $('#buyFirstTradeRow').html(html);
                }
                // Add more BuyTrade row
                function addBuyTradeRow() {
                    var html = '<div class="buyTradeRow extraBuyTradeRow"><div class="w3-container" style="width:30%;float:left">' + '<label>Loại Mua:</label>' + '<select class="w3-select">' + '<option value="9999">999.9</option>' + '<option value="NuTrang24K">Nữ Trang 24K</option>' + '<option value="680">680</option>' + '<option value="625">625</option>' + '<option value="610">610</option>' + '<option value="600">600</option>' + '<option value="560">560</option>' + '</select>' + '</div>' + '<div class="w3-container" style="width:30%;float:left">' + '<label>Cân Nặng (ly):</label> <input class="w3-input canNang"' + 'type="number" value="0" onfocus="$(this).select()">' + '</div>' + '<div class="w3-container" style="width:30%;float:left">' + '<label>Bù (ngàn/chỉ):</label> <input class="w3-input buTien"' + 'type="number" value="0" onfocus="$(this).select()">' + '</div>' + '<div class="w3-container" style="width:10%;float:left"><input class="w3-check isLa" type="checkbox">'
                    + '<label class="w3-validate">Lạ</label>' + '<a class="w3-btn w3-small" style="margin-top:12px;" onclick="$(this).parent().parent().remove()"><i class="fa fa-minus-circle" aria-hidden="true"></i></a>' + '</div></div>';
                    $('#buyTradeRow').append(html);
                }
                // Add more SellTrade row
                function addSellTradeRow() {
                    var html = '<div class="sellTradeRow extraSellTradeRow"><div class="w3-container" style="width:30%;float:left">' + '<label>Loại Bán:</label>' + '<select class="w3-select">' + '<option value="9999">999.9</option>' + '<option value="NuTrang24K">Nữ Trang 24K</option>' + '<option value="680">680</option>' + '<option value="625">625</option>' + '<option value="610">610</option>' + '<option value="600">600</option>' + '<option value="560">560</option>' + '</select>' + '</div>' + '<div class="w3-container" style="width:30%;float:left">' + '<label>Cân Nặng (ly):</label> <input class="w3-input canNang"' + 'type="number" value="0" onfocus="$(this).select()">' + '</div>' + '<div class="w3-container" style="width:30%;float:left">' + '<label>Tiền Công:</label> <input class="w3-input tienCong"' + 'type="number" value="0" onfocus="$(this).select()">' + '</div>' + '<div class="w3-container" style="width:10%;float:left">' + '<a class="w3-btn w3-xlarge" onclick="$(this).parent().parent().remove()"><i class="fa fa-minus-circle" aria-hidden="true"></i></a>' + '</div></div>';
                    $('#sellTradeRow').append(html);
                }
                // Clear BuyTrade Form
                function clearBuyTrade() {
                    $('#buyTradeRow .extraBuyTradeRow').remove();
                    $('#buyTradeRow input').val(0);
                }
                // Cal Trade
                function calTrade() {
                    var selectedOption, isProcessFurther = true,
                        goldType, price, weight, workerFee = 0, extraSub;
                    // Clear all CalArea
                    $('#calArea').children().html("");
                    
                    // Retrieve all buyTradeRow, La separate
                    $('#buyTradeRow .buyTradeRow').each(function (index) {
                        selectedOption = $(this).find('select').find(':selected');
                        weight = $(this).find('.canNang').val();
                        extraSub = $(this).find('.buTien').val();
                        if( weight <= 0){
                            alert("Kết quả sai. Xin vui lòng kiểm tra lại giá trị trong phần MUA");
                            isProcessFurther = false;
                            return;
                        }
                                                        
                        if( $(this).find('.isLa').is(":checked"))
                            $('#calBuy'+selectedOption.val()+'La').append('<span><span class="canNang">' + weight + '</span><span class="buTien">' + extraSub + '</span></span>');
                        else
                            $('#calBuy'+selectedOption.val()).append('<span><span class="canNang">' + weight + '</span><span class="buTien">' + extraSub + '</span></span>');
                    });
                    if( !isProcessFurther ) return; // Input failed
                    
                    // Retrieve all sellTradeRow
                    $('#sellTradeRow .sellTradeRow').each(function (index) {
                        selectedOption = $(this).find('select').find(':selected');
                        weight = $(this).find('.canNang').val();
                        workerFee = $(this).find('.tienCong').val();
                        if( weight <= 0){
                            alert("Kết quả sai. Xin vui lòng kiểm tra lại giá trị trong phần BÁN");
                            isProcessFurther = false;
                            return;
                        }
                        
                        $('#calSell'+selectedOption.val()).append('<span><span class="canNang">' + weight + '</span><span class="tienCong">' + workerFee + '</span></span>');
                    });
                    if( !isProcessFurther ) return; // Input failed
                    
                    // Calculate all 
                    var total = 0;
                    $('#detailContent').html("");
                    total += calTradeTotalHelper("9999");
                    total += calTradeTotalHelper("NuTrang24K");
                    total += calTradeTotalHelper("680");
                    total += calTradeTotalHelper("625");
                    total += calTradeTotalHelper("610");
                    total += calTradeTotalHelper("600");
                    total += calTradeTotalHelper("560");
                    
                    calTotal(total);

                }
                /******** END Trade Functions ******/
                
                /******** Total Functions ******/
                function calTotal( totalAmount) {
                    $('.hideActionButton').hide();
                    $('.showTotal').show();
                    $('#head').html('<button class="w3-btn w3-yellow w3-xlarge w3-round-large w3-padding-large" onclick="clickBack()">Quay Lại</button> Tổng Cộng');
                    
                    $('#totalAmount').val(totalAmount);
                    $('#getAmount').val(0);
                    $('#returnAmount').val(0);
                }
                // Trade helper calculation 
                function calTradeTotalHelper( goldTypeName) {
                    
                    var totalBuyWeight=0, totalBuyWeightLa=0, totalSellWeight=0, totalWorkerFee=0, totalExtraSub=0, totalExtraSubLa=0, currPrice=0, detailHtml="", rowTotal=0, total = 0;
                    $('#calBuy'+goldTypeName).children().each(function (index) {
                        totalBuyWeight += +$(this).find('.canNang').text();
                        totalExtraSub += +$(this).find('.buTien').text();
                    });
                    $('#calBuy'+goldTypeName+'La').children().each(function (index) {
                        totalBuyWeightLa += +$(this).find('.canNang').text();
                        totalExtraSubLa += +$(this).find('.buTien').text();
                    });
                    $('#calSell'+goldTypeName).children().each(function (index) {
                        totalSellWeight += +$(this).find('.canNang').text();
                        totalWorkerFee += +$(this).find('.tienCong').text();
                    });
                    
                    if( totalBuyWeight != 0 && totalSellWeight != 0) {
                        if( totalBuyWeight > totalSellWeight) {
                            rowTotal = (totalSellWeight - totalBuyWeight)*$('#buy'+goldTypeName).text()/100;
                        }
                        else {
                            rowTotal = Math.ceil((totalSellWeight - totalBuyWeight)*$('#sell'+goldTypeName).text()/100 + totalWorkerFee);
                        }
                        
                        detailHtml += '<li>Đổi: ' + readGoldWeight(totalBuyWeight) + ' cũ ,lấy ' + readGoldWeight(totalSellWeight) + ' mới ,vàng ' + $('#name'+goldTypeName).text() + ' ,tiền công ' + totalWorkerFee + ' ngàn ,tổng cộng ' + rowTotal + ' ngàn</li>';
                        total += rowTotal;
                    }
                    else {
                        if( totalSellWeight != 0) {
                            rowTotal = Math.ceil( ($('#sell'+goldTypeName).text() * totalSellWeight / 100) + +totalWorkerFee);
                            detailHtml += '<li>Bán: '
                                        + readGoldWeight(totalSellWeight) 
                                        + ' ,vàng ' + $('#name'+goldTypeName).text()
                                        + ' ,tiền công ' + totalWorkerFee + ' ngàn'
                                        + ' ,tổng cộng ' + rowTotal + ' ngàn'
                                        +'</li>';
                            total += rowTotal;
                        }
                        if( totalBuyWeight != 0) {
                            rowTotal = Math.ceil((+$('#buy'+goldTypeName).text() - totalExtraSub) * totalBuyWeight / 100);
                            detailHtml += '<li>Mua: '
                                            + readGoldWeight(totalBuyWeight) 
                                            + ' ,vàng: ' + $('#name'+goldTypeName).text()
                                            + ' ,tiền bù: ' + totalExtraSub + ' ngàn/chỉ'
                                            + ' ,tổng cộng: ' + rowTotal + ' ngàn'
                                            +'</li>';
                            total += -rowTotal;
                        }
                    }
                    // Do La
                    if( totalBuyWeightLa != 0) {
                        rowTotal = Math.ceil((+$('#buy'+goldTypeName).text() - totalExtraSubLa) * totalBuyWeightLa / 100);
                        detailHtml += '<li>Mua (đồ lạ): ' + readGoldWeight(totalBuyWeightLa)+ ' ,vàng: ' + $('#name'+goldTypeName).text() + ' ,tiền bù: ' + totalExtraSubLa + ' ngàn/chỉ' + ' ,tổng cộng: ' + rowTotal + ' ngàn</li>';
                        total += -rowTotal;
                    }              

                    $('#detailContent').append(detailHtml);
                    return total;
                }
                /******** END Total Functions ******/
            </script>
            <script src="./js/common.js"></script>
</body>

</html>